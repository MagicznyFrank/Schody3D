{% extends 'base.html' %}

{% block title %}
    Wynik generowania schodów
{% endblock %}

{% block content %}
    <h1>Generowanie schodów zakończone sukcesem!</h1>
    <p>Plik jest przygotowywany do otwarcia...</p>
    <script>
        function checkAndOpen() {
            fetch("{{ url_for('views.check_file', session_id=session_id) }}")
                .then(response => response.json())
                .then(data => {
                    if (data.exists) {
                        window.open("{{ url_for('views.serve_project', session_id=session_id) }}", "_blank");
                    } else {
                        setTimeout(checkAndOpen, 500);
                    }
                });
        }

        window.onload = checkAndOpen;
    </script>
    <p><a href="{{ url_for('views.download_project', session_id=session_id) }}" download>Pobierz projekt</a></p>
    <p><a href="{{ url_for('views.home') }}">Powrót do strony głównej</a></p>
{% endblock %}